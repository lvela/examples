/* Generated by Opal 0.6.2 */
(function($opal) {
  var self = $opal.top, $scope = $opal, nil = $opal.nil, $breaker = $opal.breaker, $slice = $opal.slice, $module = $opal.module, $klass = $opal.klass;

  $opal.add_stubs(['$===', '$raise', '$type_error', '$to_f', '$log', '$include']);
  return (function($base) {
    var self = $module($base, 'Math');

    var def = self._proto, $scope = self._scope, $a;

    (function($base, $super) {
      function $DomainError(){};
      var self = $DomainError = $klass($base, $super, 'DomainError', $DomainError);

      var def = self._proto, $scope = self._scope, TMP_1;

      return ($opal.defs(self, '$new', TMP_1 = function(method) {
        var self = this, $iter = TMP_1._p, $yield = $iter || nil;

        TMP_1._p = null;
        return $opal.find_super_dispatcher(self, 'new', TMP_1, null, $DomainError).apply(self, ["Numerical argument is out of domain - \"" + (method) + "\""]);
      }), nil) && 'new'
    })(self, (($a = $scope.StandardError) == null ? $opal.cm('StandardError') : $a));

    $opal.cdecl($scope, 'E', Math.E);

    $opal.cdecl($scope, 'PI', Math.PI);

    def.$acos = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      x = x.$to_f();

      if (x < -1 || x > 1) {
        self.$raise((($a = $scope.DomainError) == null ? $opal.cm('DomainError') : $a), "acos");
      }

      return Math.acos(x);
    ;
    };

    if ((($a = (typeof(Math.acosh) !== "undefined")) !== nil && (!$a._isBoolean || $a == true))) {
      } else {
      
      Math.acosh = function(x) {
        return Math.log(x + Math.sqrt(x * x - 1));
      }
    
    };

    def.$acosh = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.acosh(x.$to_f());
    ;
    };

    def.$asin = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      x = x.$to_f();

      if (x < -1 || x > 1) {
        self.$raise((($a = $scope.DomainError) == null ? $opal.cm('DomainError') : $a), "asin");
      }

      return Math.asin(x);
    ;
    };

    if ((($a = (typeof(Math.asinh) !== "undefined")) !== nil && (!$a._isBoolean || $a == true))) {
      } else {
      
      Math.asinh = function(x) {
        return Math.log(x + Math.sqrt(x * x + 1))
      }
    ;
    };

    def.$asinh = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.asinh(x.$to_f());
    ;
    };

    def.$atan = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.atan(x.$to_f());
    ;
    };

    def.$atan2 = function(x, y) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](y)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(y, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.atan2(x.$to_f(), y.$to_f());
    ;
    };

    if ((($a = (typeof(Math.atanh) !== "undefined")) !== nil && (!$a._isBoolean || $a == true))) {
      } else {
      
      Math.atanh = function(x) {
        return 0.5 * Math.log((1 + x) / (1 - x));
      }
    
    };

    def.$atanh = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      x = x.$to_f();

      if (x < -1 || x > 1) {
        self.$raise((($a = $scope.DomainError) == null ? $opal.cm('DomainError') : $a), "atanh");
      }

      return Math.atanh(x);
    ;
    };

    def.$cbrt = function(x) {
      var self = this;

      return Math.cbrt(x);
    };

    def.$cos = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.cos(x.$to_f());
    ;
    };

    if ((($a = (typeof(Math.cosh) !== "undefined")) !== nil && (!$a._isBoolean || $a == true))) {
      } else {
      
      Math.cosh = function(x) {
        return (Math.exp(x) + Math.exp(-x)) / 2;
      }
    
    };

    def.$cosh = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.cosh(x.$to_f());
    ;
    };

    def.$erf = function(x) {
      var $a, self = this;

      return self.$raise((($a = $scope.NotImplementedError) == null ? $opal.cm('NotImplementedError') : $a));
    };

    def.$erfc = function(x) {
      var $a, self = this;

      return self.$raise((($a = $scope.NotImplementedError) == null ? $opal.cm('NotImplementedError') : $a));
    };

    def.$exp = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.exp(x.$to_f());
    ;
    };

    def.$frexp = function(x) {
      var $a, self = this;

      return self.$raise((($a = $scope.NotImplementedError) == null ? $opal.cm('NotImplementedError') : $a));
    };

    def.$gamma = function(x) {
      var $a, self = this;

      return self.$raise((($a = $scope.NotImplementedError) == null ? $opal.cm('NotImplementedError') : $a));
    };

    if ((($a = (typeof(Math.hypot) !== "undefined")) !== nil && (!$a._isBoolean || $a == true))) {
      } else {
      
      Math.hypot = function(x, y) {
        return Math.sqrt(x * x + y * y)
      }
    ;
    };

    def.$hypot = function(x, y) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](y)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(y, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.hypot(x.$to_f(), y.$to_f());
    ;
    };

    def.$ldexp = function(flt, int$) {
      var $a, self = this;

      return self.$raise((($a = $scope.NotImplementedError) == null ? $opal.cm('NotImplementedError') : $a));
    };

    def.$lgamma = function(x) {
      var $a, self = this;

      return self.$raise((($a = $scope.NotImplementedError) == null ? $opal.cm('NotImplementedError') : $a));
    };

    def.$log = function(num, base, method) {
      var $a, self = this;

      if (base == null) {
        base = (($a = $scope.E) == null ? $opal.cm('E') : $a)
      }
      if (method == null) {
        method = nil
      }
      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](num)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(num, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](base)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(base, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      num  = num.$to_f();
      base = base.$to_f();

      if (num < 0) {
        self.$raise((($a = $scope.DomainError) == null ? $opal.cm('DomainError') : $a), ((($a = method) !== false && $a !== nil) ? $a : "log"));
      }

      num = Math.log(num);

      if (base != Math.E) {
        num /= Math.log(base);
      }

      return num
    ;
    };

    if ((($a = (typeof(Math.log10) !== "undefined")) !== nil && (!$a._isBoolean || $a == true))) {
      def.$log10 = function(num) {
        var $a, self = this;

        
        if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](num)) {
          self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(num, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
        }

        num = num.$to_f();

        if (num < 0) {
          self.$raise((($a = $scope.DomainError) == null ? $opal.cm('DomainError') : $a), "log2");
        }

        return Math.log10(num);
      ;
      }
      } else {
      def.$log10 = function(num) {
        var self = this;

        return self.$log(num, 10, "log10");
      }
    };

    if ((($a = (typeof(Math.log2) !== "undefined")) !== nil && (!$a._isBoolean || $a == true))) {
      def.$log2 = function(num) {
        var $a, self = this;

        
        if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](num)) {
          self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(num, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
        }

        num = num.$to_f();

        if (num < 0) {
          self.$raise((($a = $scope.DomainError) == null ? $opal.cm('DomainError') : $a), "log2");
        }

        return Math.log2(num);
      ;
      }
      } else {
      def.$log2 = function(num) {
        var self = this;

        return self.$log(num, 2, "log2");
      }
    };

    def.$sin = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.sin(x.$to_f());
    ;
    };

    if ((($a = (typeof(Math.sinh) !== "undefined")) !== nil && (!$a._isBoolean || $a == true))) {
      } else {
      
      Math.sinh = function(x) {
        return (Math.exp(x) - Math.exp(-x)) / 2;
      }
    
    };

    def.$sinh = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.sinh(x.$to_f());
    ;
    };

    def.$sqrt = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      x = x.$to_f();

      if (x < 0) {
        self.$raise((($a = $scope.DomainError) == null ? $opal.cm('DomainError') : $a), "log2");
      }

      return Math.sqrt(x);
    ;
    };

    def.$tan = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.tan(x.$to_f());
    ;
    };

    if ((($a = (typeof(Math.tanh) !== "undefined")) !== nil && (!$a._isBoolean || $a == true))) {
      } else {
      
      Math.tanh = function(x) {
        if (x == Infinity) {
          return 1;
        }
        else if (x == -Infinity) {
          return -1;
        }
        else {
          return (Math.exp(x) - Math.exp(-x)) / (Math.exp(x) + Math.exp(-x));
        }
      }
    
    };

    def.$tanh = function(x) {
      var $a, self = this;

      
      if (!(($a = $scope.Numeric) == null ? $opal.cm('Numeric') : $a)['$==='](x)) {
        self.$raise((($a = $scope.Opal) == null ? $opal.cm('Opal') : $a).$type_error(x, (($a = $scope.Float) == null ? $opal.cm('Float') : $a)));
      }

      return Math.tanh(x.$to_f());
    ;
    };

    (function(self) {
      var $scope = self._scope, def = self._proto;

      return self.$include((($a = $scope.Math) == null ? $opal.cm('Math') : $a))
    })(self.$singleton_class());
        ;$opal.donate(self, ["$acos", "$acosh", "$asin", "$asinh", "$atan", "$atan2", "$atanh", "$cbrt", "$cos", "$cosh", "$erf", "$erfc", "$exp", "$frexp", "$gamma", "$hypot", "$ldexp", "$lgamma", "$log", "$log10", "$log10", "$log2", "$log2", "$sin", "$sinh", "$sqrt", "$tan", "$tanh"]);
  })(self)
})(Opal);

//# sourceMappingURL=/__opal_source_maps__/math.js.map
;
/* Generated by Opal 0.6.2 */
(function($opal) {
  var self = $opal.top, $scope = $opal, nil = $opal.nil, $breaker = $opal.breaker, $slice = $opal.slice, $klass = $opal.klass, $hash2 = $opal.hash2;

  $opal.add_stubs(['$attr_accessor', '$fetch', '$[]']);
  return (function($base, $super) {
    function $Thing(){};
    var self = $Thing = $klass($base, $super, 'Thing', $Thing);

    var def = self._proto, $scope = self._scope;

    self.$attr_accessor("position");

    return (def.$initialize = function(args) {
      var $a, self = this;

      if (args == null) {
        args = $hash2([], {})
      }
      return self.position = args.$fetch("position", (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](0, 0));
    }, nil) && 'initialize';
  })(self, null)
})(Opal);

//# sourceMappingURL=/__opal_source_maps__/thing.js.map
;
/* Generated by Opal 0.6.2 */
(function($opal) {
  var $a, self = $opal.top, $scope = $opal, nil = $opal.nil, $breaker = $opal.breaker, $slice = $opal.slice, $klass = $opal.klass, $hash2 = $opal.hash2;

  $opal.add_stubs(['$[]', '$fetch', '$-', '$rand', '$*', '$move', '$wrap', '$+', '$>', '$-@', '$x', '$radius', '$x=', '$width', '$display', '$y', '$y=', '$height', '$<', '$distance_to', '$reject!', '$==', '$things', '$<<', '$new', '$stroke_color=', '$draw_polygon', '$private', '$/', '$push', '$translate', '$rotate', '$begin_shape', '$move_to', '$times', '$line_to', '$cos', '$sin', '$end_shape', '$stroke_shape', '$pop']);
  return (function($base, $super) {
    function $Asteroid(){};
    var self = $Asteroid = $klass($base, $super, 'Asteroid', $Asteroid);

    var def = self._proto, $scope = self._scope, $a, TMP_1;

    def.position = def.velocity = def.rotation = def.rotation_speed = def.side_count = nil;
    $opal.cdecl($scope, 'COLOR', (($a = $scope.C) == null ? $opal.cm('C') : $a)['$[]']("#ffffff"));

    $opal.cdecl($scope, 'RADIUS_PER_SIDE', 8);

    def.$initialize = TMP_1 = function(args) {var $zuper = $slice.call(arguments, 0);
      var $a, self = this, $iter = TMP_1._p, $yield = $iter || nil;

      TMP_1._p = null;
      $opal.find_super_dispatcher(self, 'initialize', TMP_1, $iter).apply(self, $zuper);
      self.side_count = args.$fetch("side_count");
      self.rotation = 0;
      self.rotation_speed = (($a = $scope.Math) == null ? $opal.cm('Math') : $a).$rand()['$-'](0.5);
      return self.velocity = (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]']((($a = $scope.Math) == null ? $opal.cm('Math') : $a).$rand()['$*'](50)['$-'](25), (($a = $scope.Math) == null ? $opal.cm('Math') : $a).$rand()['$*'](50)['$-'](25));
    };

    def.$update = function(elapsed, game) {
      var self = this;

      self.$move(elapsed);
      return self.$wrap(game);
    };

    def.$move = function(elapsed) {
      var self = this;

      self.position = self.position['$+'](self.velocity['$*'](elapsed));
      return self.rotation = self.rotation['$+'](self.rotation_speed['$*'](elapsed));
    };

    def.$wrap = function(game) {
      var self = this, left_overlap = nil, right_overlap = nil, top_overlap = nil, bottom_overlap = nil;

      if (((left_overlap = self.position.$x()['$-@']()['$-'](self.$radius())))['$>'](0)) {
        self.position['$x='](game.$display().$width()['$-'](left_overlap)['$+'](self.$radius()))
      } else if (((right_overlap = self.position.$x()['$-'](self.$radius())['$-'](game.$display().$width())))['$>'](0)) {
        self.position['$x='](right_overlap['$-'](self.$radius()))};
      if (((top_overlap = self.position.$y()['$-@']()['$-'](self.$radius())))['$>'](0)) {
        return self.position['$y='](game.$display().$height()['$-'](top_overlap)['$+'](self.$radius()))
      } else if (((bottom_overlap = self.position.$y()['$-'](self.$radius())['$-'](game.$display().$height())))['$>'](0)) {
        return self.position['$y='](bottom_overlap['$-'](self.$radius()))
        } else {
        return nil
      };
    };

    def['$colliding?'] = function(point) {
      var self = this;

      return self.position.$distance_to(point)['$<'](self.$radius());
    };

    def.$die = function(game) {
      var $a, $b, TMP_2, self = this;

      ($a = ($b = game.$things())['$reject!'], $a._p = (TMP_2 = function(t){var self = TMP_2._s || this;
if (t == null) t = nil;
      return t['$=='](self)}, TMP_2._s = self, TMP_2), $a).call($b);
      if (self.side_count['$>'](3)) {
        game.$things()['$<<']((($a = $scope.Asteroid) == null ? $opal.cm('Asteroid') : $a).$new($hash2(["position", "side_count", "velocity"], {"position": self.position, "side_count": self.side_count['$-'](1), "velocity": (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](self.velocity.$y()['$-@'](), self.velocity.$x())['$*'](2)})));
        return game.$things()['$<<']((($a = $scope.Asteroid) == null ? $opal.cm('Asteroid') : $a).$new($hash2(["position", "side_count", "velocity"], {"position": self.position, "side_count": self.side_count['$-'](1), "velocity": (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](self.velocity.$y(), self.velocity.$x()['$-@']())['$*'](2)})));
        } else {
        return nil
      };
    };

    def.$draw = function(display) {
      var $a, self = this;

      display['$stroke_color=']((($a = $scope.COLOR) == null ? $opal.cm('COLOR') : $a));
      return self.$draw_polygon(display, self.position, self.rotation, self.side_count, self.$radius());
    };

    self.$private();

    def.$radius = function() {
      var $a, self = this;

      return self.side_count['$*']((($a = $scope.RADIUS_PER_SIDE) == null ? $opal.cm('RADIUS_PER_SIDE') : $a));
    };

    return (def.$draw_polygon = function(d, position, rotation, side_count, radius) {
      var $a, $b, TMP_3, self = this, angle_per = nil;

      angle_per = (($a = ((($b = $scope.Math) == null ? $opal.cm('Math') : $b))._scope).PI == null ? $a.cm('PI') : $a.PI)['$*'](2)['$/'](side_count);
      d.$push();
      d.$translate(self.position);
      d.$rotate(self.rotation);
      d.$begin_shape();
      d.$move_to((($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](radius, 0));
      ($a = ($b = side_count).$times, $a._p = (TMP_3 = function(i){var self = TMP_3._s || this, $a;
if (i == null) i = nil;
      return d.$line_to((($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](radius['$*']((($a = $scope.Math) == null ? $opal.cm('Math') : $a).$cos(angle_per['$*'](i))), radius['$*']((($a = $scope.Math) == null ? $opal.cm('Math') : $a).$sin(angle_per['$*'](i)))))}, TMP_3._s = self, TMP_3), $a).call($b);
      d.$end_shape();
      d.$stroke_shape();
      return d.$pop();
    }, nil) && 'draw_polygon';
  })(self, (($a = $scope.Thing) == null ? $opal.cm('Thing') : $a))
})(Opal);

//# sourceMappingURL=/__opal_source_maps__/asteroid.js.map
;
/* Generated by Opal 0.6.2 */
(function($opal) {
  var $a, self = $opal.top, $scope = $opal, nil = $opal.nil, $breaker = $opal.breaker, $slice = $opal.slice, $klass = $opal.klass;

  $opal.add_stubs(['$fetch', '$[]', '$move', '$wrap', '$collide', '$self_destruct', '$along!', '$*', '$/', '$>', '$-', '$-@', '$x', '$x=', '$+', '$width', '$display', '$y', '$y=', '$height', '$each', '$respond_to?', '$colliding?', '$die', '$reject!', '$==', '$things', '$stroke_color=', '$push', '$translate', '$rotate', '$stroke_rectangle', '$pop']);
  return (function($base, $super) {
    function $Bullet(){};
    var self = $Bullet = $klass($base, $super, 'Bullet', $Bullet);

    var def = self._proto, $scope = self._scope, TMP_1;

    def.position = def.direction = def.size = def.age = nil;
    $opal.cdecl($scope, 'SPIN_SPEED', 0.6);

    $opal.cdecl($scope, 'MAX_AGE', 0.5);

    $opal.cdecl($scope, 'SPEED', 600);

    def.$initialize = TMP_1 = function(args) {var $zuper = $slice.call(arguments, 0);
      var $a, self = this, $iter = TMP_1._p, $yield = $iter || nil;

      TMP_1._p = null;
      $opal.find_super_dispatcher(self, 'initialize', TMP_1, $iter).apply(self, $zuper);
      self.direction = args.$fetch("direction");
      self.size = (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](8, 8);
      return self.age = 0;
    };

    def.$update = function(elapsed, game) {
      var self = this;

      self.$move(elapsed);
      self.$wrap(game);
      self.$collide(game);
      return self.$self_destruct(elapsed, game);
    };

    def.$move = function(elapsed) {
      var $a, self = this;

      return self.position['$along!'](self.direction, (($a = $scope.SPEED) == null ? $opal.cm('SPEED') : $a)['$*'](elapsed));
    };

    def.$wrap = function(game) {
      var self = this, half_size = nil, left_overlap = nil, right_overlap = nil, top_overlap = nil, bottom_overlap = nil;

      half_size = self.size['$/'](2);
      if (((left_overlap = self.position.$x()['$-@']()['$-'](half_size.$x())))['$>'](0)) {
        self.position['$x='](game.$display().$width()['$-'](left_overlap)['$+'](half_size.$y()))
      } else if (((right_overlap = self.position.$x()['$-'](half_size.$x())['$-'](game.$display().$width())))['$>'](0)) {
        self.position['$x='](right_overlap['$-'](half_size.$y()))};
      if (((top_overlap = self.position.$y()['$-@']()['$-'](half_size.$y())))['$>'](0)) {
        return self.position['$y='](game.$display().$height()['$-'](top_overlap)['$+'](half_size.$y()))
      } else if (((bottom_overlap = self.position.$y()['$-'](half_size.$y())['$-'](game.$display().$height())))['$>'](0)) {
        return self.position['$y='](bottom_overlap['$-'](half_size.$y()))
        } else {
        return nil
      };
    };

    def.$collide = function(game) {try {

      var $a, $b, TMP_2, self = this;

      return ($a = ($b = game.$things()).$each, $a._p = (TMP_2 = function(thing){var self = TMP_2._s || this, $a, $b, TMP_3;
        if (self.position == null) self.position = nil;
if (thing == null) thing = nil;
      if ((($a = ($b = thing['$respond_to?']("colliding?"), $b !== false && $b !== nil ?thing['$colliding?'](self.position) : $b)) !== nil && (!$a._isBoolean || $a == true))) {
          thing.$die(game);
          ($a = ($b = game.$things())['$reject!'], $a._p = (TMP_3 = function(t){var self = TMP_3._s || this;
if (t == null) t = nil;
          return t['$=='](self)}, TMP_3._s = self, TMP_3), $a).call($b);
          $opal.$return(nil);
          } else {
          return nil
        }}, TMP_2._s = self, TMP_2), $a).call($b);
      } catch ($returner) { if ($returner === $opal.returner) { return $returner.$v } throw $returner; }
    };

    def.$self_destruct = function(elapsed, game) {
      var $a, $b, TMP_4, self = this;

      self.age = self.age['$+'](elapsed);
      if (self.age['$>']((($a = $scope.MAX_AGE) == null ? $opal.cm('MAX_AGE') : $a))) {
        return ($a = ($b = game.$things())['$reject!'], $a._p = (TMP_4 = function(t){var self = TMP_4._s || this;
if (t == null) t = nil;
        return t['$=='](self)}, TMP_4._s = self, TMP_4), $a).call($b)
        } else {
        return nil
      };
    };

    return (def.$draw = function(d) {
      var $a, $b, self = this;

      d['$stroke_color=']((($a = ((($b = $scope.Ship) == null ? $opal.cm('Ship') : $b))._scope).COLOR == null ? $a.cm('COLOR') : $a.COLOR));
      d.$push();
      d.$translate(self.position);
      d.$rotate((0.785)['$+'](self.direction));
      d.$stroke_rectangle(self.size['$/'](-2), self.size);
      return d.$pop();
    }, nil) && 'draw';
  })(self, (($a = $scope.Thing) == null ? $opal.cm('Thing') : $a))
})(Opal);

//# sourceMappingURL=/__opal_source_maps__/bullet.js.map
;
/* Generated by Opal 0.6.2 */
(function($opal) {
  var $a, self = $opal.top, $scope = $opal, nil = $opal.nil, $breaker = $opal.breaker, $slice = $opal.slice, $klass = $opal.klass, $hash2 = $opal.hash2;

  $opal.add_stubs(['$[]', '$*', '$control', '$move', '$wrap', '$collide', '$input', '$+', '$-', '$<<', '$things', '$new', '$along!', '$/', '$>', '$-@', '$x', '$x=', '$width', '$display', '$y', '$y=', '$height', '$each', '$respond_to?', '$colliding?', '$die', '$initialize', '$stroke_color=', '$push', '$translate', '$rotate', '$begin_shape', '$move_to', '$line_to', '$end_shape', '$stroke_shape', '$pop']);
  return (function($base, $super) {
    function $Ship(){};
    var self = $Ship = $klass($base, $super, 'Ship', $Ship);

    var def = self._proto, $scope = self._scope, $a, TMP_1;

    def.direction = def.position = def.thrusting = def.velocity = def.size = nil;
    $opal.cdecl($scope, 'COLOR', (($a = $scope.C) == null ? $opal.cm('C') : $a)['$[]']("#ffff88"));

    $opal.cdecl($scope, 'SPEED', 5);

    $opal.cdecl($scope, 'ROTATE_SPEED', 5);

    def.$initialize = TMP_1 = function(args) {var $zuper = $slice.call(arguments, 0);
      var $a, $b, self = this, $iter = TMP_1._p, $yield = $iter || nil;

      TMP_1._p = null;
      $opal.find_super_dispatcher(self, 'initialize', TMP_1, $iter).apply(self, $zuper);
      self.size = (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](32, 32);
      self.velocity = (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](0, 0);
      self.direction = (($a = ((($b = $scope.Math) == null ? $opal.cm('Math') : $b))._scope).PI == null ? $a.cm('PI') : $a.PI)['$*'](1.5);
      return self.args = args;
    };

    def.$update = function(elapsed, game) {
      var self = this;

      self.$control(elapsed, game);
      self.$move(elapsed, game);
      self.$wrap(game);
      return self.$collide(game);
    };

    def.$control = function(elapsed, game) {
      var $a, self = this;

      if ((($a = game.$input()['$[]']("right")) !== nil && (!$a._isBoolean || $a == true))) {
        self.direction = self.direction['$+']((($a = $scope.ROTATE_SPEED) == null ? $opal.cm('ROTATE_SPEED') : $a)['$*'](elapsed))};
      if ((($a = game.$input()['$[]']("left")) !== nil && (!$a._isBoolean || $a == true))) {
        self.direction = self.direction['$-']((($a = $scope.ROTATE_SPEED) == null ? $opal.cm('ROTATE_SPEED') : $a)['$*'](elapsed))};
      self.thrusting = game.$input()['$[]']("up");
      if ((($a = game.$input()['$[]']("shoot")) !== nil && (!$a._isBoolean || $a == true))) {
        return game.$things()['$<<']((($a = $scope.Bullet) == null ? $opal.cm('Bullet') : $a).$new($hash2(["position", "direction"], {"position": self.position, "direction": self.direction})))
        } else {
        return nil
      };
    };

    def.$move = function(elapsed, game) {
      var $a, self = this;

      if ((($a = self.thrusting) !== nil && (!$a._isBoolean || $a == true))) {
        self.velocity['$along!'](self.direction, (($a = $scope.SPEED) == null ? $opal.cm('SPEED') : $a)['$*'](elapsed))};
      return self.position = self.position['$+'](self.velocity);
    };

    def.$wrap = function(game) {
      var self = this, half_size = nil, left_overlap = nil, right_overlap = nil, top_overlap = nil, bottom_overlap = nil;

      half_size = self.size['$/'](2);
      if (((left_overlap = self.position.$x()['$-@']()['$-'](half_size.$x())))['$>'](0)) {
        self.position['$x='](game.$display().$width()['$-'](left_overlap)['$+'](half_size.$y()))
      } else if (((right_overlap = self.position.$x()['$-'](half_size.$x())['$-'](game.$display().$width())))['$>'](0)) {
        self.position['$x='](right_overlap['$-'](half_size.$y()))};
      if (((top_overlap = self.position.$y()['$-@']()['$-'](half_size.$y())))['$>'](0)) {
        return self.position['$y='](game.$display().$height()['$-'](top_overlap)['$+'](half_size.$y()))
      } else if (((bottom_overlap = self.position.$y()['$-'](half_size.$y())['$-'](game.$display().$height())))['$>'](0)) {
        return self.position['$y='](bottom_overlap['$-'](half_size.$y()))
        } else {
        return nil
      };
    };

    def.$collide = function(game) {try {

      var $a, $b, TMP_2, self = this;

      return ($a = ($b = game.$things()).$each, $a._p = (TMP_2 = function(thing){var self = TMP_2._s || this, $a, $b;
        if (self.position == null) self.position = nil;
        if (self.args == null) self.args = nil;
if (thing == null) thing = nil;
      if ((($a = ($b = thing['$respond_to?']("colliding?"), $b !== false && $b !== nil ?thing['$colliding?'](self.position) : $b)) !== nil && (!$a._isBoolean || $a == true))) {
          thing.$die(game);
          self.$initialize(self.args);
          $opal.$return(nil);
          } else {
          return nil
        }}, TMP_2._s = self, TMP_2), $a).call($b);
      } catch ($returner) { if ($returner === $opal.returner) { return $returner.$v } throw $returner; }
    };

    return (def.$draw = function(d) {
      var $a, $b, self = this;

      d['$stroke_color=']((($a = $scope.COLOR) == null ? $opal.cm('COLOR') : $a));
      d.$push();
      d.$translate(self.position);
      d.$rotate(self.direction['$+']((($a = ((($b = $scope.Math) == null ? $opal.cm('Math') : $b))._scope).PI == null ? $a.cm('PI') : $a.PI)['$/'](2)));
      d.$translate(self.size['$-@']()['$/'](2));
      d.$begin_shape();
      d.$move_to((($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](self.size.$x()['$/'](2), 0));
      d.$line_to((($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](self.size.$x(), self.size.$y()));
      d.$line_to((($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](self.size.$x()['$/'](2), self.size.$y()['$/'](2)));
      d.$line_to((($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](0, self.size.$y()));
      d.$line_to((($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](self.size.$x()['$/'](2), 0));
      d.$end_shape();
      d.$stroke_shape();
      if ((($a = self.thrusting) !== nil && (!$a._isBoolean || $a == true))) {
        d.$begin_shape();
        d.$move_to((($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](self.size.$x()['$/'](2), self.size.$y()['$/'](2)));
        d.$line_to((($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](self.size.$x()['$/'](2), self.size.$y()));
        d.$end_shape();
        d.$stroke_shape();};
      return d.$pop();
    }, nil) && 'draw';
  })(self, (($a = $scope.Thing) == null ? $opal.cm('Thing') : $a))
})(Opal);

//# sourceMappingURL=/__opal_source_maps__/ship.js.map
;
/* Generated by Opal 0.6.2 */
(function($opal) {
  var self = $opal.top, $scope = $opal, nil = $opal.nil, $breaker = $opal.breaker, $slice = $opal.slice;

  $opal.add_stubs([]);
  ;
  ;
  ;
  return true;
})(Opal);

//# sourceMappingURL=/__opal_source_maps__/things.js.map
;
/* Generated by Opal 0.6.2 */
(function($opal) {
  var $a, self = $opal.top, $scope = $opal, nil = $opal.nil, $breaker = $opal.breaker, $slice = $opal.slice, $klass = $opal.klass, $hash2 = $opal.hash2;

  $opal.add_stubs(['$[]', '$attr_accessor', '$[]=', '$config', '$<<', '$new', '$/', '$size', '$display', '$times', '$*', '$rand', '$width', '$height', '$stroke_color=', '$stroke_width=', '$fill_color=', '$pressing?', '$keyboard', '$pressed?', '$clear', '$each', '$nil?', '$update', '$draw', '$draw_help', '$private', '$font_size=', '$fill_text']);
  ;
  ;
  return (function($base, $super) {
    function $AsteroidsGame(){};
    var self = $AsteroidsGame = $klass($base, $super, 'AsteroidsGame', $AsteroidsGame);

    var def = self._proto, $scope = self._scope, $a;

    def.things = def.input = nil;
    $opal.cdecl($scope, 'BG_COLOR', (($a = $scope.C) == null ? $opal.cm('C') : $a)['$[]']("#001133"));

    self.$attr_accessor("input", "things");

    self.$config()['$[]']("display")['$[]=']("size", (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](720, 720));

    def.$setup = function() {
      var $a, $b, TMP_1, self = this;

      self.things = [];
      self.things['$<<']((($a = $scope.Ship) == null ? $opal.cm('Ship') : $a).$new($hash2(["position"], {"position": self.$display().$size()['$/'](2)})));
      ($a = ($b = (6)).$times, $a._p = (TMP_1 = function(){var self = TMP_1._s || this, $a;
        if (self.things == null) self.things = nil;

      return self.things['$<<']((($a = $scope.Asteroid) == null ? $opal.cm('Asteroid') : $a).$new($hash2(["position", "side_count"], {"position": (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]']((($a = $scope.Math) == null ? $opal.cm('Math') : $a).$rand()['$*'](self.$display().$width()), (($a = $scope.Math) == null ? $opal.cm('Math') : $a).$rand()['$*'](self.$display().$height())), "side_count": 6})))}, TMP_1._s = self, TMP_1), $a).call($b);
      self.input = $hash2([], {});
      self.shot = false;
      self.$display()['$stroke_color=']((($a = $scope.C) == null ? $opal.cm('C') : $a)['$[]']("#dddddd"));
      self.$display()['$stroke_width='](4);
      return self.$display()['$fill_color=']((($a = $scope.BG_COLOR) == null ? $opal.cm('BG_COLOR') : $a));
    };

    def.$update = function(elapsed) {
      var $a, $b, TMP_2, self = this;

      self.input['$[]=']("left", self.$keyboard()['$pressing?']("left"));
      self.input['$[]=']("right", self.$keyboard()['$pressing?']("right"));
      self.input['$[]=']("up", self.$keyboard()['$pressing?']("up"));
      self.input['$[]=']("shoot", self.$keyboard()['$pressed?']("z"));
      self.$display()['$fill_color=']((($a = $scope.BG_COLOR) == null ? $opal.cm('BG_COLOR') : $a));
      self.$display().$clear();
      ($a = ($b = self.things).$each, $a._p = (TMP_2 = function(t){var self = TMP_2._s || this, $a;
if (t == null) t = nil;
      if ((($a = t['$nil?']()) !== nil && (!$a._isBoolean || $a == true))) {
          return nil;};
        t.$update(elapsed, self);
        return t.$draw(self.$display());}, TMP_2._s = self, TMP_2), $a).call($b);
      return self.$draw_help(self.$display());
    };

    self.$private();

    return (def.$draw_help = function(d) {
      var $a, self = this;

      d['$font_size='](16);
      d['$fill_color=']((($a = $scope.C) == null ? $opal.cm('C') : $a)['$[]']("#999999"));
      d.$fill_text("Left/Right - Turn", (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](500, 100));
      d.$fill_text("Up - Thrust", (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](500, 120));
      return d.$fill_text("z - Shoot", (($a = $scope.V) == null ? $opal.cm('V') : $a)['$[]'](500, 140));
    }, nil) && 'draw_help';
  })(self, (($a = $scope.Game) == null ? $opal.cm('Game') : $a));
})(Opal);

//# sourceMappingURL=/__opal_source_maps__/game.js.map
;
